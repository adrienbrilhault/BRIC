<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Recursive outlier filtering based on unimodality and multinormality tests — filter_outliers • BRIC</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Recursive outlier filtering based on unimodality and multinormality tests — filter_outliers" />
<meta property="og:description" content="Recursive outlier filtering based on unimodality and multinormality tests" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-200250973-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-200250973-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRIC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Notebooks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/demo_ArtificialData.html">Demo Artificial Data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/adrienbrilhault/BRIC/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Recursive outlier filtering based on unimodality and multinormality tests</h1>
    <small class="dont-index">Source: <a href='https://github.com/adrienbrilhault/BRIC/blob/master/pkg/R/filter_outliers.R'><code>R/filter_outliers.R</code></a></small>
    <div class="hidden name"><code>filter_outliers.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Recursive outlier filtering based on unimodality and multinormality tests</p>
    </div>

    <pre class="usage"><span class='fu'>filter_outliers</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>center</span>,
  test <span class='op'>=</span> <span class='st'>"Mardia"</span>,
  threshold <span class='op'>=</span> <span class='fl'>0.05</span>,
  <span class='va'>distType</span>,
  trimmedPerIteration <span class='op'>=</span> <span class='fl'>1</span>,
  debug <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warnings <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Matrix or Data-Frame of numerical values containing the
observations (rows correspond to observations, columns to variables)</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>Coordinates used to computes the distances of the samples and
order them (array of numerical two values, for X and Y)</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>Statistical test to use. Valid options are "DIP" for unimodality
test, "Mardia", "Kurtosis", "Skewness", "KS", "KS-adj", "Shapiro",
"Lillie", and "Chisq" for multivariate normality test, or a  or a
user-defined function (see details below)</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>Threshold of significance for the statistical test (between
0 and 1, default: 0.05)</p></td>
    </tr>
    <tr>
      <th>distType</th>
      <td><p>Distance metric used to order the samples. Valid options are
"Euclidean", "MCD", "MVE", and "OGK". If empty or NULL, "Euclidean" will be
automatically selected for unimodality tests, and "MCD" for normality tests</p></td>
    </tr>
    <tr>
      <th>trimmedPerIteration</th>
      <td><p>Number of samples trimmed at each iteration
(positive integer, default: 1)</p></td>
    </tr>
    <tr>
      <th>debug</th>
      <td><p>Logical value. <code>TRUE</code> will compute all p.values, even after
exceeding the threshold, for plotting purpose (see <code><a href='plot.BRIC.Filtering.html'>plot.BRIC.Filtering()</a></code>)</p></td>
    </tr>
    <tr>
      <th>warnings</th>
      <td><p>Logical value, to display the warnings and errors caught</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns an S3 object of type <code>BRIC.Filtering</code> containing
the following values:</p>
<dt><code>call</code></dt><dd><p>Parameters of the call (contains
<code>data</code>, <code>test</code>, <code>testType</code>, <code>center</code>, <code>threshold</code>, <code>trimmedPerIteration</code>
and <code>distType</code>)</p></dd> <dt><code>distances</code></dt><dd><p>Distances of each sample from <code>data</code> to
the <code>center</code> provided</p></dd> <dt><code>p.values</code></dt><dd><p>P.Values of the test at each
iteration</p></dd> <dt><code>index.p.values</code></dt><dd><p>Subset size corresponding to each
P.Value, for plotting purpose</p></dd> <dt><code>selected</code></dt><dd><p>Indices of the samples
from <code>data</code> selected at the end of the filtering</p></dd>
<dt><code>cutoffDistance</code></dt><dd><p>Distance of the furthest inlier selected</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For unimodality tests parameter <code>distType</code> should be set to
"Euclidean" (as the distribution might contains a large amount of
outliers). For normality tests robust distances are preferable, using a
robust estimate estimates of location and scatter ("MCD","MVE", or "OGK")</p>
<p>For user-defined functions, the function should output the p.value of the
test (between 0 and 1), and receive the 3 following arguments:</p><ul>
<li><p><code>data</code> - the matrix of observations</p></li>
<li><p><code>center</code> - estimate of the center of the observations</p></li>
<li><p><code>distances</code> - distances from each observations to the <code>center</code>
(based on <code>distType</code> metric)</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Adrien Brilhault, Sergio Neuenschwander, and Ricardo Rios - A New
Robust Multivariate Mode Estimator for Eye-tracking Calibration - Behavior
Research Methods, 2022 - <a href='https://rdcu.be/cI9Pf'>rdcu.be/cI9Pf</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.BRIC.Filtering.html'>plot.BRIC.Filtering()</a></code>, <code><a href='print.BRIC.Filtering.html'>print.BRIC.Filtering()</a></code>, <code><a href='clustBRIC.html'>clustBRIC()</a></code>,
<code><a href='median_rec.html'>median_rec()</a></code>, <code><a href='median_mv.html'>median_mv()</a></code>, <code><a href='depth_values.html'>depth_values()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Example 1</span>

<span class='co'># Illustrative data</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span>
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>300</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>3</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>15</span>, <span class='fl'>20</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10</span>, <span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>-</span> <span class='fl'>0.5</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>200</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Compute an estimate for the center</span>
<span class='va'>center</span> <span class='op'>&lt;-</span> <span class='fu'><a href='median_rec.html'>median_rec</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>$</span><span class='va'>median</span>

<span class='co'># Remove non unimodal outliers from this location</span>
<span class='va'>filtering</span> <span class='op'>&lt;-</span> <span class='fu'>filter_outliers</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>center</span>, test <span class='op'>=</span> <span class='st'>"DIP"</span>, debug <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>filtering</span>, maxDisplayed <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; =&gt; Results for filter_outlier() using DIP Unimodality Test (p.value &gt; 0.05) and Euclidean Distances
#&gt;    750 samples: 411 selected, 339 filtered (1 trimmed per iteration)
#&gt; 
#&gt; Selected indices:
#&gt;   [1]   8  48 167 194 232 247 251 132 284  27  23 123 143 254 125  16 252 263
#&gt;  [19] 290 180 104 192  33 201  75 188 148 273 227  42 299 112 193 300 164  51
#&gt;  [37] 259 272  25 643 215 185 107 242 137 173 231  41 288  19 266 200 244 246
#&gt;  [55]  62  91  37  87 277 157 264 260 171  69 115 165  77   3 136 124 190  74
#&gt;  [73] 138  64 170 128 267  31 187  39  35  30  10 236 162 279 156 110   5 270
#&gt;  [91] 182  93 278 207 285   7 218 142 153 181 101  38 217 282  65  55 195  45
#&gt; [109] 221  67 243  70 130 134 109  95 168 146  24 261 152   2 213 269 121 158
#&gt; [127]  40 224  15 208 103 114 145 108  14 126 292 183 289  78 257 214  89   9
#&gt; [145] 199 298 178 175  79 161 151  88 234   1 198  44 117  72 262 296 216 297
#&gt; [163]  58 155 275 135 189 295  20 163 139 159 118 203  50 160  49 241  98 258
#&gt; [181] 283 291 197 287  66 106 281 656  34  52 169 211  18  85  17 172 237 238
#&gt; [199] 154  81
#&gt;  ... (211 hidden)
#&gt; 
#&gt; DIP Test p.values:
#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt;  [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt;  ... (548 hidden)
#&gt; 
#&gt; Outliers cutoff distance from center (0.011365990124182, 0.634105094296041):
#&gt; [1] 15.93026
#&gt; 
#&gt; 
#&gt; Euclidean Distances:
#&gt;   [1] 1.66051355 1.42746459 1.02741983 2.89153761 1.15692877 2.53224780
#&gt;   [7] 1.19380223 0.03467554 1.62335364 1.11909636 4.20571576 2.45426161
#&gt;  [13] 2.94657925 1.51731093 1.48783613 0.44943319 2.09875486 2.05862062
#&gt;  [19] 0.85787440 1.79307856 3.85085095 4.00908966 0.39093915 1.38395443
#&gt;  [25] 0.75537766 2.88665866 0.36956734 2.41947350 2.37071927 1.10531038
#&gt;  [31] 1.09349513 3.99113184 0.53684055 1.99750928 1.10161165 3.02657793
#&gt;  [37] 0.89912897 1.25365448 1.09686081 1.48141312 0.84001558 0.65463140
#&gt;  [43] 3.26947333 1.68398114 1.28989760 2.23721152 5.11656222 0.06424946
#&gt;  [49] 1.88465695 1.87481900 0.70795027 2.03227204 3.14156842 2.53810782
#&gt;  [55] 1.26669613 2.60817649 3.73381390 1.73081487 2.62626113 2.81280359
#&gt;  [61] 3.72385387 0.88644859 2.95577329 1.07582024 1.26161012 1.93046638
#&gt;  [67] 1.29451502 3.04189091 0.98271660 1.32031519 3.43030198 1.70596171
#&gt;  [73] 2.80054526 1.06902493 0.59019989 2.67971116 1.02393181 1.57464855
#&gt;  [79] 1.63619015 2.60732472 2.15850679 2.52871806 2.76315058 2.84805605
#&gt;  [85] 2.06826467 2.48400401 0.90534752 1.64898948 1.59315141 3.14755903
#&gt;  [91] 0.89439907 2.50116251 1.16963899 2.31070800 1.36363776 2.76679101
#&gt;  [97] 2.69667566 1.89789895 2.50293614 2.99394655 1.23397450 2.65478218
#&gt; [103] 1.50443275 0.51941246 2.52166775 1.93489277 0.79492689 1.50910814
#&gt; [109] 1.35089210 1.15003418 2.69394184 0.68907187 3.36853461 1.50789025
#&gt; [115] 1.00527018 4.03865600 1.69730271 1.86975638 3.42230201 3.25715520
#&gt; [121] 1.46179718 3.25114126 0.40089523 1.05572148 0.44669282 1.52914734
#&gt; [127] 2.87256528 1.08201197 3.39726259 1.32528051 2.80802702 0.32232161
#&gt; [133] 3.31985120 1.34489652 1.75857893 1.04851999 0.81075600 1.07267926
#&gt; [139] 1.82094821 3.26162335 3.14034224 1.21401000 0.43110922 2.17145318
#&gt; [145] 1.50880735 1.38256010 2.35743587 0.63432109 2.45667178 3.23396597
#&gt; [151] 1.64831501 1.41599789 1.21635770 2.15640071 1.74809629 1.14063940
#&gt; [157] 0.93436578 1.46818903 1.82519996 1.88304442 1.63807691 1.12567333
#&gt; [163] 1.80488717 0.70375638 1.00798480 3.20529882 0.09892462 1.36586030
#&gt; [169] 2.03546870 1.07587893 0.97646497 2.10814506 0.81237478 2.77026099
#&gt; [175] 1.62782004 2.49795585 2.70354173 1.62720321 2.46804355 0.48182896
#&gt; [181] 1.23059066 1.16549576 1.54900271 3.39155587 0.79257122 3.67136357
#&gt; [187] 1.09389844 0.59212397 1.76228705 1.06458968 2.96038894 0.52016012
#&gt; [193] 0.69177804 0.23312434 1.28968600 3.69224489 1.90981150 1.66085998
#&gt; [199] 1.62374755 0.86369866
#&gt;  ... (550 hidden)
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>filtering</span><span class='op'>)</span>
</div><div class='img'><img src='filter_outliers-1.svg' alt='' width='701' height='701' /></div><div class='input'>
<span class='co'>## Example 2</span>

<span class='co'># Illustrative data</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span>
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>300</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>4</span> <span class='op'>-</span> <span class='fl'>1.5</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>400</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Compute an estimate for the center</span>
<span class='va'>center</span> <span class='op'>&lt;-</span> <span class='fu'><a href='median_rec.html'>median_rec</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>$</span><span class='va'>median</span>

<span class='co'># Remove non normal outliers from this location</span>
<span class='va'>filtering</span> <span class='op'>&lt;-</span> <span class='fu'>filter_outliers</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>center</span>, test <span class='op'>=</span> <span class='st'>"Chisq"</span>, distType <span class='op'>=</span> <span class='st'>"MVE"</span>, debug <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>filtering</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; =&gt; Results for filter_outlier() using Chisq Normality Test (p.value &gt; 0.05) and MVE-based Robust Distances
#&gt;    450 samples: 312 selected, 138 filtered (1 trimmed per iteration)
#&gt; 
#&gt; Selected indices:
#&gt;   [1] 142 220   3 266  27  93  96 292  88 206 160 216 182 221 152 174  41 289
#&gt;  [19] 194  72 137 296  89 200 254 190 159  51  80 283  40 183  22 143 241 163
#&gt;  [37] 249  79 267 117 291 272 210 274 154 191 187 138 130  17 285 108 192   4
#&gt;  [55] 223  25 106 196 260  76   5 253 203 145 193  92  11 141  71 236 227  19
#&gt;  [73] 217 281 214 139 263 123 224  99 114  58  74  97 126 264 247  49 101 112
#&gt;  [91] 135  47  48 212 215 134 140  64  46 102  59  86  69  95  24 269 278 201
#&gt; [109] 280 288 230 105  50   8  31 293  68  14 132   1 245   6  36 150 218 239
#&gt; [127] 151  98 243  26 168  54  12  62 251  82  53 175  38 287 158 170 110 116
#&gt; [145] 258  10 252  78 109  63 275  65 235 147 207  84 146 185 256 195 261 111
#&gt; [163]  94 119 209 208 144  87 234  73 257   2  67  20 250  56  29 284 148 176
#&gt; [181]  32 180 181  33 226 157  90 169 276 103 246 279 240 177 297 265  45 299
#&gt; [199] 155 136
#&gt;  ... (112 hidden)
#&gt; 
#&gt; CHISQ Test p.values:
#&gt;   [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;   [6] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [11] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [16] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [21] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [26] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [31] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [36] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [41] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [46] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [51] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [56] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [61] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [66] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [71] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [76] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [81] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [86] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [91] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [96] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [101] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [106] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [111] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [116] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [121] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [126] 0.000000e+00 0.000000e+00 0.000000e+00 1.110223e-16 2.398082e-14
#&gt; [131] 2.285172e-12 7.519307e-11 2.440201e-08 8.717828e-07 3.551593e-06
#&gt; [136] 5.770196e-05 2.773836e-03 1.728143e-02 1.382876e-01 1.954700e-01
#&gt; [141] 4.861152e-01 7.955824e-01 9.854785e-01 9.394004e-01 8.441641e-01
#&gt; [146] 6.873714e-01 4.754075e-01 4.006747e-01 3.934665e-01 3.736345e-01
#&gt; [151] 3.001587e-01 2.669022e-01 1.933023e-01 1.244442e-01 9.654303e-02
#&gt; [156] 9.630380e-02 1.109996e-01 6.593546e-02 7.476827e-02 5.677226e-02
#&gt; [161] 4.262498e-02 3.664231e-02 3.424381e-02 3.509581e-02 2.859397e-02
#&gt; [166] 2.384023e-02 2.677165e-02 3.176696e-02 1.802168e-02 2.090059e-02
#&gt; [171] 2.759864e-02 2.877302e-02 3.142055e-02 2.890586e-02 2.317046e-02
#&gt; [176] 2.314730e-02 2.774281e-02 2.218321e-02 2.163211e-02 1.910937e-02
#&gt; [181] 2.098572e-02 1.742168e-02 1.455536e-02 1.337701e-02 1.386481e-02
#&gt; [186] 1.295153e-02 1.299092e-02 1.148974e-02 1.188317e-02 1.110963e-02
#&gt; [191] 9.075902e-03 9.183701e-03 8.545216e-03 6.380190e-03 7.208317e-03
#&gt; [196] 5.518663e-03 5.131843e-03 3.819120e-03 5.108844e-03 6.897259e-03
#&gt;  ... (248 hidden)
#&gt; 
#&gt; Outliers cutoff distance from center (0.19355056458096, -0.222054754873913):
#&gt; [1] 6.05625
#&gt; 
#&gt; 
#&gt; MVE-based Robust Distances:
#&gt;   [1] 1.04987299 1.32803847 0.03046107 0.67371401 0.71181636 1.05574862
#&gt;   [7] 1.64463293 1.00759795 1.67428652 1.17476436 0.75411351 1.11765980
#&gt;  [13] 1.89234214 1.03909205 1.56915106 2.61695208 0.64933964 1.85713510
#&gt;  [19] 0.77634611 1.33294790 2.11958180 0.50933535 2.63270503 0.95750363
#&gt;  [25] 0.67640286 1.10704148 0.09860585 1.74577773 1.34863593 2.15204757
#&gt;  [31] 1.03093200 1.36947168 1.38572636 1.59116006 1.67280252 1.06149858
#&gt;  [37] 2.04996001 1.13710297 2.09934004 0.47895679 0.36056474 2.19935386
#&gt;  [43] 2.80877524 1.51457505 1.48689777 0.94414674 0.88395072 0.90089265
#&gt;  [49] 0.86294007 1.00181999 0.46292646 2.00311684 1.12428968 1.11746872
#&gt;  [55] 1.62633260 1.34413329 1.77946392 0.82264435 0.94994894 2.72085715
#&gt;  [61] 1.91156856 1.12022394 1.19906477 0.94299435 1.20534892 1.52225794
#&gt;  [67] 1.32952290 1.03423006 0.95463388 1.87452411 0.76189477 0.37154641
#&gt;  [73] 1.31111840 0.82377166 1.68690641 0.70963901 1.76726608 1.18783416
#&gt;  [79] 0.55169725 0.46625187 1.66836376 1.12252252 1.58906419 1.22095583
#&gt;  [85] 1.51110826 0.95249305 1.27930374 0.24984807 0.39923923 1.40690034
#&gt;  [91] 2.45462193 0.75334317 0.12286493 1.24912156 0.95511982 0.15154855
#&gt;  [97] 0.85092790 1.10272946 0.80941674 1.54831214 0.86544309 0.94739137
#&gt; [103] 1.42502294 1.99731134 1.00126431 0.68560424 1.66010312 0.65686088
#&gt; [109] 1.19566052 1.16754109 1.24814911 0.86623808 1.54983094 0.81819561
#&gt; [115] 2.59008722 1.17317612 0.56778838 2.44343031 1.25091560 2.08917869
#&gt; [121] 2.39333302 1.68190926 0.80718059 1.88620034 1.69407632 0.85109302
#&gt; [127] 1.88103731 1.54798298 2.06938154 0.64201889 1.89818764 1.04606521
#&gt; [133] 2.04300308 0.92182432 0.87757215 1.51018895 0.37378170 0.63755817
#&gt; [139] 0.78985073 0.93467345 0.76181094 0.01172427 0.52139581 1.26308631
#&gt; [145] 0.73148717 1.22848875 1.20825716 1.35701696 1.55205415 1.06233950
#&gt; [151] 1.08852735 0.34649122 1.92686950 0.62048527 1.50370030 1.91225561
#&gt; [157] 1.40090310 1.15480591 0.45233643 0.33129591 1.56640422 1.61025952
#&gt; [163] 0.54559346 1.78252970 1.59546661 1.97722015 1.99991857 1.11250425
#&gt; [169] 1.41181476 1.16427753 1.60876505 1.57793682 2.00756361 0.35403606
#&gt; [175] 1.13286758 1.35923462 1.47349591 2.36199466 2.02298876 1.37943972
#&gt; [181] 1.38318518 0.33570175 0.48749182 1.96392429 1.22909679 1.93420380
#&gt; [187] 0.63644723 2.26690418 1.81548900 0.42756847 0.63362451 0.65695119
#&gt; [193] 0.74164048 0.36491441 1.23165768 0.68575551 1.63054770 2.13249681
#&gt; [199] 2.07246585 0.40834796
#&gt;  ... (250 hidden)
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>filtering</span>, asp <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='img'><img src='filter_outliers-2.svg' alt='' width='701' height='701' /></div><div class='input'>
<span class='co'>## Examples of user-defined tests</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='va'>customTest1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>center</span>, <span class='va'>distances</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'>diptest</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/diptest/man/dip.test.html'>dip.test</a></span><span class='op'>(</span><span class='va'>distances</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p.value</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'>filter_outliers</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>center</span>, test <span class='op'>=</span> <span class='va'>customTest1</span>,
                distType <span class='op'>=</span> <span class='st'>"Euclidean"</span>, debug <span class='op'>=</span> <span class='cn'>TRUE</span>, warnings <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>customTest2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>center</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/ks.test.html'>ks.test</a></span><span class='op'>(</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/mahalanobis.html'>mahalanobis</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>center</span>, <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>, tol <span class='op'>=</span> <span class='fl'>1e-8</span><span class='op'>)</span>,
                        <span class='st'>"pchisq"</span>, df <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p.value</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>filtering</span> <span class='op'>&lt;-</span> <span class='fu'>filter_outliers</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>center</span>, distType <span class='op'>=</span> <span class='st'>"Euclidean"</span>,
                             test <span class='op'>=</span> <span class='va'>customTest2</span>, debug <span class='op'>=</span> <span class='cn'>TRUE</span>, warnings <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>customTest3</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'>ICS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ICS/man/mvnorm.skew.test.html'>mvnorm.skew.test</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p.value</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>filtering</span> <span class='op'>&lt;-</span> <span class='fu'>filter_outliers</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>center</span>, distType <span class='op'>=</span> <span class='st'>"Euclidean"</span>,
                             test <span class='op'>=</span> <span class='va'>customTest3</span>, threshold <span class='op'>=</span> <span class='fl'>0.1</span>, debug <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.linkedin.com/in/adrienbrilhault/'>Adrien Brilhault</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


